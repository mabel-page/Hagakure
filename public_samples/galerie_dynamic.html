<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Galerie – Hagakure KC</title>
  <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
  <div data-include="partials/header.html"></div>
  <main id="main">
    <h1>Galerie</h1>
    <p class="small">Albums récents. Cliquez pour ouvrir un album.</p>
    <section id="albumGrid" class="gallery" aria-live="polite"></section>
  </main>
  <div data-include="partials/footer.html"></div>
  <script type="module" src="assets/js/includes.js"></script>
  <script>
  (async function(){
    const grid = document.getElementById('albumGrid');
    grid.innerHTML = '<article class="card">Chargement…</article>';
    try{
      const r = await fetch('/api/albums');
      const list = await r.json();
      if(!list.length){ grid.innerHTML = '<article class="card">Aucun album pour l’instant.</article>'; return; }
      grid.innerHTML = list.map(a => `
        <article class="card">
          <a href="album.html?slug=${encodeURIComponent(a.slug)}" class="album-card">
            ${a.cover ? `<img src="${a.cover}" alt="${a.title}">` : ''}
            <h3>${a.title}</h3>
            <p class="small">${a.count} photo(s)</p>
          </a>
        </article>
      `).join('');
    }catch(e){
      grid.innerHTML = '<article class="card">Erreur de chargement.</article>';
    }
  })();
  </script>
</body>
</html>
